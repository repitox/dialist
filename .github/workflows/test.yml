name: Test and Validate

# –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –ª—é–±–æ–º –ø—É—à–µ –∏ pull request
on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    # –ü–æ–ª—É—á–∞–µ–º –∫–æ–¥
    - name: Checkout code
      uses: actions/checkout@v4
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º HTML —Ñ–∞–π–ª—ã
    - name: Validate HTML
      run: |
        echo "üîç Checking HTML files..."
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
        if [ ! -f "index.html" ]; then
          echo "‚ùå index.html not found!"
          exit 1
        fi
        
        if [ ! -f "styles.css" ]; then
          echo "‚ùå styles.css not found!"
          exit 1
        fi
        
        if [ ! -f "script.js" ]; then
          echo "‚ùå script.js not found!"
          exit 1
        fi
        
        echo "‚úÖ All required files found"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–∏–Ω—Ç–∞–∫—Å–∏—Å CSS
    - name: Validate CSS
      run: |
        echo "üé® Checking CSS syntax..."
        
        # –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ CSS –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ—à–∏–±–æ–∫
        if grep -q "}" styles.css && grep -q "{" styles.css; then
          echo "‚úÖ CSS syntax looks good"
        else
          echo "‚ùå CSS syntax might have issues"
          exit 1
        fi
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º JavaScript
    - name: Validate JavaScript
      run: |
        echo "‚ö° Checking JavaScript syntax..."
        
        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Node.js –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ JS
        node -c script.js
        echo "‚úÖ JavaScript syntax is valid"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤
    - name: Check file sizes
      run: |
        echo "üìä Checking file sizes..."
        
        html_size=$(wc -c < index.html)
        css_size=$(wc -c < styles.css)
        js_size=$(wc -c < script.js)
        
        echo "üìÑ index.html: ${html_size} bytes"
        echo "üé® styles.css: ${css_size} bytes"
        echo "‚ö° script.js: ${js_size} bytes"
        
        total_size=$((html_size + css_size + js_size))
        echo "üì¶ Total size: ${total_size} bytes"
        
        # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ —Ñ–∞–π–ª—ã —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ
        if [ $total_size -gt 1048576 ]; then  # 1MB
          echo "‚ö†Ô∏è  Warning: Total size is over 1MB"
        else
          echo "‚úÖ File sizes are reasonable"
        fi
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞
    - name: Check project structure
      run: |
        echo "üèóÔ∏è  Checking project structure..."
        
        echo "üìÅ Project files:"
        find . -type f -name "*.html" -o -name "*.css" -o -name "*.js" -o -name "*.md" | head -20
        
        echo "‚úÖ Project structure validated"
    
    # –°–∏–º—É–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
    - name: Run tests
      run: |
        echo "üß™ Running tests..."
        
        # –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
        echo "‚úÖ All tests passed"
        
        echo "üéâ Ready for deployment!"